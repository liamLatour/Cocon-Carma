<!DOCTYPE html>
<html lang="fr">
<!--Déclaration des paramètre généraux de la page (les caractères utilisé, le titre, et autre)-->
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="nouveauPlat.css">
    <link rel="stylesheet" href="menu.css">    
    <title>Cocon Carma</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<!--Ici commence le vrai code-->
<body>

    <div id="menu">
        <div id="menuContainer">
            <ul>
                <li><a href="index.html">Nouvelle commande</a></li>
                <li><a href="mesCommandes.html">Mes commandes</a></li>
                <li><a href="mesPlats.html">Mes plats</a></li>
            </ul>
        </div>
        <div id="hamClick"></div>
        <div id="hamburger">
            <div class="bar1"></div>
            <div class="bar2"></div>
            <div class="bar3"></div>
        </div>        
    </div>

    <div id="modal">
        <div id="content">
            <h2>Nouveau plat ajouté !</h2>
            <p>Voulez-vous en ajoutez un autre, 
            allez voir vos différents plats enregistrées ou vos statistics ?</p>
            <a href="mesPlats.html" class="leftLink">Mes Plats</a>
            <a href="nouveauPlat.html" class="midLink">Encore un !</a>
            <a href="" class="rightLink">Mes Stats</a>
        </div>
    </div>

    <h1>Ajouter Un Plat</h1>

    <label id="titre">
        <input type="text" name="titre" value="Soupe d'automne" onblur="if (this.value == '') {this.value = 'Soupe d\'automne';}"  onfocus="if (this.value == 'Soupe d\'automne') {this.value = '';}">
        <span class="required" title="Obligatoire"></span>
    </label>

    <textarea id="description"></textarea>

    <label id="prix">
        <input type="text" name="prix" value="5.3" size="4" onblur="if (this.value == '') {this.value = '5.3';}"  onfocus="if (this.value == '5.3') {this.value = '';}">
        <span class="required" title="Obligatoire"></span>
    </label>

    <input id="submit" type="submit" value="Ajouter">


<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="main.js"></script>
<script>
    var get = window.location.search.substr(1);
    var idd;
    if(get != null && get.includes("itemId")){
        idd = Number(get.replace("itemId=", ""));
        let obj = JSON.parse(localStorage.getItem("item"+idd));
        $("#titre input").val(obj.title);
        $("#description").val(obj.description);
        $("#prix input").val(obj.price);

        //pour que ça 'fit'
        $("h1").html("Modifier Un Plat");
        $("#submit").val("Modifier");
        $("#modal h2").html("Plat modifié !");
        $("#modal p").html("Voulez-vous allez voir vos différents plats enregistrées ou vos statistics ?");
        $("#modal .midLink").remove();
    }    

    $("#submit").on('click', function(){
        if(Number($("#prix input").val()) <= 0){
            return;
        }

        save({
            title: $("#titre input").val(),
            description: $("#description").val(),
            price: $("#prix input").val()
        }, "item", id=idd);

        $("#modal").css("visibility", "visible");
    });
</script>
</body>
</html>